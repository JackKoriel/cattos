{
  "info": {
    "_postman_id": "9a6f2dfb-77b6-4a83-9b40-0f2f3d2c2c1e",
    "name": "Cattos API",
    "schema": "https://schema.getpostman.com/json/collection/v2.1.0/collection.json",
    "description": "Cattos Express API (/api). Includes Users and Posts requests with variables and test scripts to auto-save IDs."
  },
  "item": [
    {
      "name": "Meta",
      "item": [
        {
          "name": "Root - API Running",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{baseUrl}}/",
              "host": ["{{baseUrl}}"],
              "path": [""]
            }
          }
        },
        {
          "name": "Health",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{baseUrl}}/api/health",
              "host": ["{{baseUrl}}"],
              "path": ["api", "health"]
            }
          }
        }
      ]
    },
    {
      "name": "Users",
      "item": [
        {
          "name": "Get All Users",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{baseUrl}}/api/users?limit=20&skip=0",
              "host": ["{{baseUrl}}"],
              "path": ["api", "users"],
              "query": [
                { "key": "limit", "value": "20" },
                { "key": "skip", "value": "0" }
              ]
            }
          }
        },
        {
          "name": "Search Users",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{baseUrl}}/api/users/search?q={{userSearchQuery}}&limit=20&skip=0",
              "host": ["{{baseUrl}}"],
              "path": ["api", "users", "search"],
              "query": [
                { "key": "q", "value": "{{userSearchQuery}}" },
                { "key": "limit", "value": "20" },
                { "key": "skip", "value": "0" }
              ]
            }
          }
        },
        {
          "name": "Get User By Username",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{baseUrl}}/api/users/username/{{username}}",
              "host": ["{{baseUrl}}"],
              "path": ["api", "users", "username", "{{username}}"]
            }
          }
        },
        {
          "name": "Get User By Id",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{baseUrl}}/api/users/{{userId}}",
              "host": ["{{baseUrl}}"],
              "path": ["api", "users", "{{userId}}"]
            }
          }
        },
        {
          "name": "Create User",
          "event": [
            {
              "listen": "test",
              "script": {
                "type": "text/javascript",
                "exec": [
                  "const json = pm.response.json();",
                  "const data = json && json.data ? json.data : null;",
                  "const id = data && (data._id || data.id);",
                  "const username = data && data.username;",
                  "if (id) pm.environment.set('userId', id);",
                  "if (username) pm.environment.set('username', username);"
                ]
              }
            }
          ],
          "request": {
            "method": "POST",
            "header": [{ "key": "Content-Type", "value": "application/json" }],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"email\": \"{{newUserEmail}}\",\n  \"username\": \"{{newUserUsername}}\",\n  \"displayName\": \"{{newUserDisplayName}}\",\n  \"avatar\": \"{{newUserAvatar}}\",\n  \"bio\": \"Meow. I post cat photos.\"\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/api/users",
              "host": ["{{baseUrl}}"],
              "path": ["api", "users"]
            }
          }
        },
        {
          "name": "Update User (PATCH)",
          "request": {
            "method": "PATCH",
            "header": [{ "key": "Content-Type", "value": "application/json" }],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"displayName\": \"{{updateUserDisplayName}}\",\n  \"bio\": \"{{updateUserBio}}\",\n  \"avatar\": \"{{updateUserAvatar}}\",\n  \"coverImage\": \"{{updateUserCoverImage}}\",\n  \"location\": \"{{updateUserLocation}}\",\n  \"website\": \"{{updateUserWebsite}}\"\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/api/users/{{userId}}",
              "host": ["{{baseUrl}}"],
              "path": ["api", "users", "{{userId}}"]
            }
          }
        }
      ]
    },
    {
      "name": "Posts",
      "item": [
        {
          "name": "Get All Posts",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{baseUrl}}/api/posts?limit=20&skip=0",
              "host": ["{{baseUrl}}"],
              "path": ["api", "posts"],
              "query": [
                { "key": "limit", "value": "20" },
                { "key": "skip", "value": "0" }
              ]
            }
          }
        },
        {
          "name": "Get Posts By Author",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{baseUrl}}/api/posts?authorId={{userId}}&limit=20&skip=0",
              "host": ["{{baseUrl}}"],
              "path": ["api", "posts"],
              "query": [
                { "key": "authorId", "value": "{{userId}}" },
                { "key": "limit", "value": "20" },
                { "key": "skip", "value": "0" }
              ]
            }
          }
        },
        {
          "name": "Get Post By Id",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{baseUrl}}/api/posts/{{postId}}",
              "host": ["{{baseUrl}}"],
              "path": ["api", "posts", "{{postId}}"]
            }
          }
        },
        {
          "name": "Get Replies For Post",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{baseUrl}}/api/posts/{{postId}}/replies?limit=20&skip=0",
              "host": ["{{baseUrl}}"],
              "path": ["api", "posts", "{{postId}}", "replies"],
              "query": [
                { "key": "limit", "value": "20" },
                { "key": "skip", "value": "0" }
              ]
            }
          }
        },
        {
          "name": "Get Posts By Hashtag",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{baseUrl}}/api/posts/hashtag/{{hashtag}}?limit=20&skip=0",
              "host": ["{{baseUrl}}"],
              "path": ["api", "posts", "hashtag", "{{hashtag}}"],
              "query": [
                { "key": "limit", "value": "20" },
                { "key": "skip", "value": "0" }
              ]
            }
          }
        },
        {
          "name": "Create Post",
          "event": [
            {
              "listen": "test",
              "script": {
                "type": "text/javascript",
                "exec": [
                  "const json = pm.response.json();",
                  "const data = json && json.data ? json.data : null;",
                  "const id = data && (data._id || data.id);",
                  "if (id) pm.environment.set('postId', id);"
                ]
              }
            }
          ],
          "request": {
            "method": "POST",
            "header": [{ "key": "Content-Type", "value": "application/json" }],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"authorId\": \"{{userId}}\",\n  \"content\": \"{{newPostContent}}\",\n  \"mediaUrls\": [],\n  \"visibility\": \"public\"\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/api/posts",
              "host": ["{{baseUrl}}"],
              "path": ["api", "posts"]
            }
          }
        },
        {
          "name": "Update Post (PATCH)",
          "request": {
            "method": "PATCH",
            "header": [{ "key": "Content-Type", "value": "application/json" }],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"authorId\": \"{{userId}}\",\n  \"content\": \"{{updatePostContent}}\",\n  \"visibility\": \"public\"\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/api/posts/{{postId}}",
              "host": ["{{baseUrl}}"],
              "path": ["api", "posts", "{{postId}}"]
            }
          }
        },
        {
          "name": "Delete Post",
          "request": {
            "method": "DELETE",
            "header": [{ "key": "Content-Type", "value": "application/json" }],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"authorId\": \"{{userId}}\"\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/api/posts/{{postId}}",
              "host": ["{{baseUrl}}"],
              "path": ["api", "posts", "{{postId}}"]
            }
          }
        }
      ]
    }
  ]
}
